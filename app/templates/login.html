{% extends "base.html" %}
{% block content %}
  <section class="page-header">
    <h2>{{ '注册新账号' if mode == 'register' else '登录控制台' }}</h2>
    {% if mode == 'register' %}
      {% if registration_mode == 'invite' %}
      <p>当前注册需提供有效邀请码。</p>
      {% elif registration_mode == 'closed' %}
      <p class="hint">注册已暂停，请联系管理员。</p>
      {% else %}
      <p>认证后即可接入 SDK、查看运行数据并自定义主题。</p>
      {% endif %}
    {% else %}
      <p>使用已有账号登录 AllYend 控制台。</p>
    {% endif %}
  </section>
  <div class="card" style="max-width: 420px; margin: 0 auto;">
    <h3 style="margin-top: 0;">{{ '注册' if mode == 'register' else '登录' }}</h3>
    {% if error %}
    <div class="notice" style="margin-bottom:12px; color:#b91c1c; background: rgba(248,113,113,0.1);">{{ error }}</div>
    {% endif %}
    <form method="post" action="/{{ 'register' if mode == 'register' else 'login' }}" class="form-grid">
      <label for="username">用户名</label>
      <input id="username" type="text" name="username" value="{{ username or '' }}" required />
      <label for="password">密码</label>
      <input id="password" type="password" name="password" required />
      {% if mode == 'register' %}
      <label for="display_name">显示名称</label>
      <input id="display_name" type="text" name="display_name" value="{{ display_name or '' }}" placeholder="可选，默认与用户名一致" />
      <label for="email">邮箱</label>
      <input id="email" type="email" name="email" value="{{ email or '' }}" placeholder="可选，用于通知" />
      <label for="invite_code">邀请码（可选）</label>
      <input id="invite_code" type="text" name="invite_code" value="{{ invite_code or '' }}" {% if registration_mode == 'invite' %}required{% endif %} />
      {% endif %}
      <button type="submit">{{ '注册并进入' if mode == 'register' else '登录系统' }}</button>
    </form>
    {% if mode == 'register' %}
    <p class="hint">已有账号？<a href="/login">返回登录</a></p>
    {% else %}
    <p class="hint">还没有账号？<a href="/register">立即注册</a></p>
    {% endif %}
  </div>
{% endblock %}
