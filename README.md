# 诱捕式 /admin 假后台 + 真后台日志面板（演示）

> 说明：未登录管理员访问 `/admin` 会进入“诱捕假后台”，所有操作均记录到 SQLite；管理员访问 `/admin` 将跳转至 `/aaadmin`（真后台）查看与导出日志。

## 功能概览

- 非管理员：访问 `/admin` 自动进入假后台（账号管理、主页修改、主页装修、广告管理、数据库管理、打包/下载等均为仿真操作），不发生跳转
- 诱捕日志：记录访问 IP、UA、路径、方法、动作标识与请求体（JSON）
- 真后台：管理员访问 `/admin` 会跳转至 `/aaadmin`，可查看日志（分页检索）、导出 CSV、查看会话概览
- 伪下载：默认安全模式，返回小压缩包 + 警示说明；可通过环境变量切换到“更高压缩比演示”（仍避免极端危险结构）

## 运行要求

- Node.js 18+

## 安装与启动

```bash
npm install
npm start
# 访问 http://localhost:3000
```

## 环境变量

- `PORT`：服务端口（默认 3000）
- `SESSION_SECRET`：会话密钥（默认占位，生产必须修改）
- `ADMIN_PASSWORD`：管理员密码（默认 `admin123`，生产必须修改）
 - `SAFE_DECOY_DOWNLOAD`：是否启用安全伪下载（默认 `true`）。当设置为 `false` 时，启用更高压缩比演示（请务必在隔离测试环境自评风险）。

## 数据存储

- 数据库：`data/honeypot.db`（SQLite，WAL 模式）
- 表：
  - `honeypot_sessions`：非管理员会话登记
  - `honeypot_events`：诱捕事件（时间、路径、动作、载荷等）

## 安全与合规建议

- 强烈建议：将真实管理员路径与假后台路径分离（例如真实 `/super-admin`），同时为 `/admin` 提供诱捕界面
- 默认“伪下载”为安全模式，不会制造危险压缩炸弹；若必须做更逼真的演示，请务必在隔离/一次性环境验证，避免对第三方或自身环境造成危害和合规风险
- 对假后台的所有入参要彻底视为不可信：已启用最小限度解析，并全部只做“记录”，不触达真实系统
- 建议配合 WAF、速率限制、IP 黑名单/灰度评估使用

## 登录与路径说明

- 管理员登录页：`/login`（默认密码见上）
- 未登录访问 `/admin` → 假后台（不跳转）
- 管理员访问 `/admin` → 跳转 `/aaadmin`（真后台）

## 目录结构

```
src/server.js         # 主服务
views/                # EJS 视图（fake/real，使用 express-ejs-layouts 布局）
public/css/style.css  # 简洁样式
data/honeypot.db      # 运行后生成的 SQLite 数据库
```

## 免责声明

本项目仅用于安全研究与演示，默认策略为“安全伪下载”。请勿在未授权环境对第三方使用任何可能造成资源耗尽或破坏的手段。使用者需自行承担使用风险与合规责任。
