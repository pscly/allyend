<h1>诱捕日志</h1>

<form method="get" class="toolbar">
  <input type="text" name="q" value="<%= q %>" placeholder="搜索 action/path/ip/payload" />
  <button type="submit">搜索</button>
  <a class="btn" href="/aaadmin/logs/export">导出 CSV</a>
  <a class="btn" href="/aaadmin">返回</a>
  <span class="muted">共 <%= total %> 条</span>
  <span class="muted">第 <%= page %> 页</span>
  <% if (page > 1) { %>
    <a href="/aaadmin/logs?page=<%= page-1 %>&q=<%= encodeURIComponent(q) %>">上一页</a>
  <% } %>
  <% if (page * pageSize < total) { %>
    <a href="/aaadmin/logs?page=<%= page+1 %>&q=<%= encodeURIComponent(q) %>">下一页</a>
  <% } %>
  
</form>

<div class="table-wrap">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>时间</th>
        <th>会话</th>
        <th>IP</th>
        <th>方法</th>
        <th>路径</th>
        <th>动作</th>
        <th>载荷</th>
        <th>UA</th>
      </tr>
    </thead>
    <tbody>
      <% rows.forEach(r => { %>
        <tr>
          <td><%= r.id %></td>
          <td><%= r.ts %></td>
          <td class="mono"><%= r.session_id %></td>
          <td><%= r.ip %></td>
          <td><%= r.method %></td>
          <td class="mono"><%= r.path %></td>
          <td><%= r.action %></td>
          <td class="mono small"><%= r.payload %></td>
          <td class="small"><%= r.user_agent %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>
  
</div>
